{% extends 'core/base.html' %}

{% block title %}Stock Recommendations - StockLearn{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl text-white p-8 mb-8 relative overflow-hidden">
        <div class="relative z-10">
            <div class="flex items-center space-x-4 mb-4">
                <div class="w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center">
                    <i class="fas fa-chart-line text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl font-bold mb-2">Weekly Stock Recommendations</h1>
                    <p class="text-blue-100 text-lg">Expert-curated stock picks with detailed analysis and insights</p>
                </div>
            </div>
            <div class="flex items-center space-x-6 text-blue-100">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-calendar-check"></i>
                    <span>Updated Weekly</span>
                </div>
                <div class="flex items-center space-x-2">
                    <i class="fas fa-chart-bar"></i>
                    <span>Data-Driven Analysis</span>
                </div>
                <div class="flex items-center space-x-2">
                    <i class="fas fa-shield-alt"></i>
                    <span>Risk Assessment Included</span>
                </div>
            </div>
        </div>
        <!-- Background decorations -->
        <div class="absolute top-0 right-0 w-40 h-40 bg-white bg-opacity-10 rounded-full -translate-y-20 translate-x-20"></div>
        <div class="absolute bottom-0 left-0 w-32 h-32 bg-white bg-opacity-10 rounded-full translate-y-16 -translate-x-16"></div>
    </div>

    <!-- Performance Metrics -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-arrow-up text-green-600 text-xl"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1">+24.5%</div>
            <div class="text-sm text-gray-600">Avg. Return</div>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-percentage text-blue-600 text-xl"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1">78%</div>
            <div class="text-sm text-gray-600">Success Rate</div>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
            <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-star text-purple-600 text-xl"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1">{{ recommendations|length }}</div>
            <div class="text-sm text-gray-600">Active Picks</div>
        </div>
        <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
            <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-clock text-orange-600 text-xl"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1">7 days</div>
            <div class="text-sm text-gray-600">Update Frequency</div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        {% for rec in recommendations %}
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
            <!-- Stock Header -->
            <div class="bg-gradient-to-r 
                {% if rec.recommendation == 'buy' %}from-green-500 to-emerald-600
                {% elif rec.recommendation == 'sell' %}from-red-500 to-orange-600
                {% else %}from-yellow-500 to-amber-600{% endif %} 
                p-6 text-white">
                <div class="flex justify-between items-start">
                    <div>
                        <h2 class="text-2xl font-bold mb-1">{{ rec.stock_symbol }}</h2>
                        <p class="text-white text-opacity-90">{{ rec.company_name }}</p>
                    </div>
                    <div class="text-right">
                        <span class="inline-block bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold backdrop-blur-sm">
                            {{ rec.recommendation|title }}
                        </span>
                        <div class="mt-2 text-white text-opacity-90 text-sm">
                            <i class="fas fa-calendar-alt mr-1"></i>
                            {{ rec.published_date|date:"M d, Y" }}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stock Data -->
            <div class="p-6">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="text-center p-4 bg-gray-50 rounded-xl border border-gray-200">
                        <p class="text-sm text-gray-600 mb-1 flex items-center justify-center">
                            <i class="fas fa-dollar-sign mr-1 text-gray-500"></i>
                            Current Price
                        </p>
                        <p class="text-2xl font-bold text-gray-800">${{ rec.current_price }}</p>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-xl border border-gray-200">
                        <p class="text-sm text-gray-600 mb-1 flex items-center justify-center">
                            <i class="fas fa-bullseye mr-1 text-gray-500"></i>
                            Target Price
                        </p>
                        <p class="text-2xl font-bold text-gray-800">${{ rec.target_price }}</p>
                        {% with potential=rec.target_price|floatformat:2|add:0 current=rec.current_price|floatformat:2|add:0 %}
                        {% with change=potential|subtract:current percent_change=change|div:current|mul:100 %}
                        <p class="text-sm mt-1 {% if change > 0 %}text-green-600{% else %}text-red-600{% endif %}">
                            {% if change > 0 %}+{% endif %}{{ percent_change|floatformat:1 }}%
                        </p>
                        {% endwith %}
                        {% endwith %}
                    </div>
                </div>

                <!-- Risk and Sector Info -->
                <div class="flex flex-wrap gap-3 mb-6">
                    <div class="flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg">
                        <i class="fas fa-exclamation-triangle 
                            {% if rec.risk_level == 'low' %}text-green-500
                            {% elif rec.risk_level == 'medium' %}text-yellow-500
                            {% else %}text-red-500{% endif %}"></i>
                        <span class="text-sm font-medium text-gray-700">Risk: {{ rec.risk_level|title }}</span>
                    </div>
                    {% if rec.sector %}
                    <div class="flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg">
                        <i class="fas fa-industry text-blue-500"></i>
                        <span class="text-sm font-medium text-gray-700">{{ rec.sector }}</span>
                    </div>
                    {% endif %}
                    {% if rec.market_cap %}
                    <div class="flex items-center space-x-2 bg-gray-100 px-3 py-2 rounded-lg">
                        <i class="fas fa-chart-pie text-purple-500"></i>
                        <span class="text-sm font-medium text-gray-700">{{ rec.market_cap }}</span>
                    </div>
                    {% endif %}
                </div>

                <!-- Analysis Section -->
                <div class="border-t border-gray-200 pt-4">
                    <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-analytics text-blue-500 mr-2"></i>
                        Analysis
                    </h3>
                    <p class="text-gray-700 leading-relaxed">{{ rec.analysis }}</p>
                    
                    <!-- Key Points -->
                    {% if rec.key_points %}
                    <div class="mt-4 bg-blue-50 rounded-xl p-4 border border-blue-200">
                        <h4 class="font-medium text-blue-800 mb-2 flex items-center">
                            <i class="fas fa-key mr-2"></i>
                            Key Points
                        </h4>
                        <ul class="text-sm text-blue-700 space-y-1">
                            {% for point in rec.key_points %}
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5 flex-shrink-0"></i>
                                <span>{{ point }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>

                <!-- Action Buttons -->
                <div class="mt-6 flex space-x-3">
                    <button class="flex-1 bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition duration-200 flex items-center justify-center space-x-2">
                        <i class="fas fa-chart-line"></i>
                        <span>View Detailed Analysis</span>
                    </button>
                    <button class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center text-gray-600 hover:bg-gray-200 transition duration-200">
                        <i class="far fa-bookmark"></i>
                    </button>
                </div>
            </div>
        </div>
        {% empty %}
        <!-- Empty State -->
        <div class="col-span-2 text-center py-16">
            <div class="w-24 h-24 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-chart-line text-3xl text-gray-400"></i>
            </div>
            <h3 class="text-2xl font-semibold text-gray-700 mb-3">No Recommendations Available</h3>
            <p class="text-gray-600 max-w-md mx-auto mb-6">
                Our analysts are currently researching new investment opportunities. Check back soon for updated recommendations.
            </p>
            <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 max-w-md mx-auto">
                <p class="text-yellow-800 text-sm flex items-center justify-center space-x-2">
                    <i class="fas fa-lightbulb text-yellow-500"></i>
                    <span><strong>Tip:</strong> Follow our market insights for early access to new recommendations</span>
                </p>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Upgrade Banner -->
    {% if user.subscription_tier != 'premium' %}
    <div class="mt-12 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl p-8 text-white text-center relative overflow-hidden">
        <div class="relative z-10">
            <div class="w-20 h-20 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-crown text-2xl"></i>
            </div>
            <h3 class="text-2xl font-bold mb-3">Unlock Premium Stock Recommendations</h3>
            <p class="text-purple-100 text-lg max-w-2xl mx-auto mb-6">
                Get access to our complete portfolio of stock picks, advanced analysis tools, and real-time alerts. 
                Join thousands of successful investors using our premium research.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-3xl mx-auto mb-8">
                <div class="bg-white bg-opacity-10 p-4 rounded-xl backdrop-blur-sm">
                    <i class="fas fa-chart-bar text-2xl mb-2"></i>
                    <h4 class="font-semibold mb-1">Advanced Analytics</h4>
                    <p class="text-purple-100 text-sm">Deep dive into financial metrics and projections</p>
                </div>
                <div class="bg-white bg-opacity-10 p-4 rounded-xl backdrop-blur-sm">
                    <i class="fas fa-bell text-2xl mb-2"></i>
                    <h4 class="font-semibold mb-1">Real-time Alerts</h4>
                    <p class="text-purple-100 text-sm">Instant notifications on price targets and updates</p>
                </div>
                <div class="bg-white bg-opacity-10 p-4 rounded-xl backdrop-blur-sm">
                    <i class="fas fa-file-alt text-2xl mb-2"></i>
                    <h4 class="font-semibold mb-1">Detailed Reports</h4>
                    <p class="text-purple-100 text-sm">Comprehensive research reports for each pick</p>
                </div>
            </div>
            <button class="bg-white text-purple-600 px-8 py-3 rounded-xl font-bold text-lg hover:bg-gray-100 transition duration-200 transform hover:scale-105">
                Upgrade to Premium - $29/month
            </button>
        </div>
        <!-- Background decorations -->
        <div class="absolute top-0 right-0 w-32 h-32 bg-white bg-opacity-10 rounded-full -translate-y-16 translate-x-16"></div>
        <div class="absolute bottom-0 left-0 w-24 h-24 bg-white bg-opacity-10 rounded-full translate-y-12 -translate-x-12"></div>
    </div>
    {% endif %}

    <!-- Disclaimer -->
    <div class="mt-8 bg-gray-50 rounded-2xl p-6 border border-gray-200">
        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
            <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
            Investment Disclaimer
        </h3>
        <p class="text-sm text-gray-600">
            Stock recommendations are for educational purposes only and should not be considered as financial advice. 
            Past performance is not indicative of future results. Always conduct your own research and consider your 
            financial situation before making investment decisions. StockLearn is not responsible for any investment 
            losses incurred based on these recommendations.
        </p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Add interactive elements and animations
document.addEventListener('DOMContentLoaded', function() {
    // Add loading animations for cards
    const cards = document.querySelectorAll('.bg-white.rounded-2xl');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });

    // Bookmark functionality
    const bookmarkButtons = document.querySelectorAll('button .fa-bookmark');
    bookmarkButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
            const icon = this;
            if (icon.classList.contains('far')) {
                icon.classList.remove('far');
                icon.classList.add('fas', 'text-blue-500');
                showNotification('Stock added to watchlist', 'success');
            } else {
                icon.classList.remove('fas', 'text-blue-500');
                icon.classList.add('far');
                showNotification('Stock removed from watchlist', 'info');
            }
        });
    });

    // Notification function
    function showNotification(message, type = 'info') {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 p-4 rounded-xl shadow-lg text-white font-semibold transform translate-x-full transition-transform duration-300 ${
            type === 'success' ? 'bg-green-500' : 
            type === 'error' ? 'bg-red-500' : 'bg-blue-500'
        }`;
        notification.innerHTML = `
            <div class="flex items-center space-x-2">
                <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info'}"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
            notification.classList.remove('translate-x-full');
        }, 100);
        
        // Remove after 3 seconds
        setTimeout(() => {
            notification.classList.add('translate-x-full');
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 3000);
    }
});
</script>

<style>
/* Custom styles for enhanced appearance */
.transition-transform {
    transition: transform 0.3s ease;
}

/* Hover effects for interactive elements */
.hover\\:shadow-xl:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

/* Smooth transitions for all elements */
* {
    transition: all 0.2s ease;
}
</style>
{% endblock %} 